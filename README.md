# Symfony Overview

## 1. Введение

Этот репозиторий — короткий и понятный вход в мир **Symfony** — современного PHP-фреймворка для создания веб-приложений и API.

Здесь ты сможешь:

- быстро понять, **что такое Symfony** и чем он отличается от других фреймворков;
- узнать, **когда его имеет смысл использовать** (и когда, возможно, нет);
- получить **пошаговый гайд по запуску первого проекта**;
- посмотреть **примеры кода**: маршруты, контроллеры, шаблоны, работа с БД и API;
- увидеть, как вписать Symfony в привычный стек: Git, Docker, CI/CD, macOS.

> Цель: сделать так, чтобы после прочтения одного README ты мог(ла) развернуть рабочий проект на Symfony, понимать общую архитектуру и спокойно двигаться дальше по официальной документации и туториалам.

## 2. Что такое Symfony

**Symfony** — это современный, модульный **PHP-фреймворк** и одновременно **набор отдельных компонентов**, которые можно использовать как вместе, так и по отдельности.

Ключевые идеи Symfony:

- **Фреймворк полного стека**  
  Позволяет написать всё приложение “под ключ”: роутинг, контроллеры, шаблоны, формы, работа с БД, безопасность, консольные команды и т.д.

- **Набор компонентов**  
  Symfony состоит из десятков независимых компонент (Routing, HTTP Foundation, Console, EventDispatcher и др.), которые можно использовать в любом PHP-проекте, даже без самого фреймворка.

- **Сервис-контейнер и DI (Dependency Injection)**  
  Вся логика оформляется как сервисы, которыми управляет контейнер. Это упрощает тестирование, переиспользование и поддержку кода.

- **Гибкая архитектура**  
  Symfony не жёстко привязан к “чистому” MVC, но использует похожий подход: контроллеры принимают HTTP-запрос, вызывают доменную логику (сервисы/модели) и возвращают HTTP-ответ (чаще всего через шаблон Twig или JSON).

- **Enterprise-уровень**  
  Фреймворк ориентирован на долгоживущие, расширяемые проекты, с упором на стандарты, тестируемость и предсказуемые релизы (LTS-версии).

Если коротко: **Symfony — это фундамент для серьёзных веб-приложений и API**, который даёт строгую структуру, мощный набор инструментов и при этом остаётся достаточно гибким, чтобы подстроиться под архитектурный стиль проекта.

## 3. Основные возможности и преимущества Symfony

Symfony даёт целый набор мощных инструментов “из коробки”, которые помогают быстро писать поддерживаемый и расширяемый код.

### Ключевые возможности

- **Роутинг (Routing)**  
  Гибкая система маршрутизации: описываешь URL → указываешь, какой контроллер и метод должен выполниться. Поддерживаются параметры, требования (регекспы), префиксы, группы маршрутов и атрибуты в коде.

- **Контроллеры и HTTP-слой**  
  Контроллеры работают поверх компонента HttpFoundation: удобные объекты `Request` и `Response`, работа с сессией, файлами, куками, редиректами и т.д.

- **Шаблоны Twig**  
  Twig — быстрый и безопасный шаблонизатор: наследование шаблонов, блоки, фильтры, циклы, условия, защита от XSS по умолчанию. Отлично подходит для разметки HTML и email-шаблонов.

- **Работа с БД через Doctrine ORM**  
  Поддержка сущностей, миграций, репозиториев, связей (OneToMany, ManyToMany и т.п.). Можно описывать модель БД на PHP-классах и не писать “сырой” SQL везде.

- **Формы и валидация**  
  Мощный Form компонент: генерация HTML-форм, биндинг данных к объектам, валидация через аннотации/атрибуты/конфиг, удобные сообщения об ошибках.

- **Безопасность и аутентификация**  
  Готовые механизмы логина (form login, HTTP basic, JWT через бандлы), роли, права доступа, “firewalls”. Удобная защита маршрутов через конфиг и атрибуты.

- **Консольные команды**  
  Компонент Console позволяет создавать CLI-команды: миграции, крон-скрипты, задачи администрирования и обслуживание проекта.

- **Событийная модель и подписчики**  
  EventDispatcher позволяет “подслушивать” события фреймворка и своего приложения и реагировать на них без жёсткой связки частей кода.

---

### Почему Symfony стоит использовать

- **Строгая структура и стандарты**  
  Symfony придерживается PSR-стандартов, поощряет чистую архитектуру и делает код предсказуемым для всей команды.

- **Модульность и переиспользование**  
  Можно использовать как целый фреймворк, так и отдельные компоненты в любых PHP-проектах.

- **Масштабируемость**  
  Подходит и для небольших сервисов, и для крупных монолитов/enterprise-систем, которые развиваются годами.

- **Экосистема и сообщество**  
  Богатый набор бандлов, интеграция с популярными библиотеками, большое сообщество и хорошая документация.

- **Тестируемость**  
  Встроенная поддержка unit, functional и интеграционных тестов, удобная работа с моками и тестовым окружением.

> Идея: Symfony даёт не просто “набор функций”, а **целостный каркас** приложения, который помогает писать код, который легко развивать, тестировать и поддерживать в долгую.

## 4. Требования к окружению

Перед тем как начинать работать с Symfony, важно подготовить минимальное окружение.

### Версия PHP

Актуальные версии Symfony требуют современный PHP:

- Для свежих проектов рекомендуется PHP 8.2+ (уточняй в composer.json конкретной версии фреймворка).
- В продакшене желательно включённый opcache для производительности.

Проверить версию:
php -v

---

### Обязательные расширения PHP

Symfony опирается на ряд стандартных расширений PHP (обычно уже есть в нормальной сборке PHP):

- ctype
- iconv
- mbstring
- json
- openssl
- pcre
- session
- simplexml
- tokenizer
- xml

Плюс расширение для работы с нужной БД:
- pdo_mysql — для MySQL/MariaDB
- pdo_pgsql — для PostgreSQL
- pdo_sqlite — для SQLite

Посмотреть список расширений:
php -m

---

### Composer

Symfony использует Composer для управления зависимостями.

- Нужен глобально установленный Composer.
- Минимальная версия — актуальная стабильная (2.x).

Проверка:
composer -V

---

### Symfony CLI (рекомендуется)

Официальная утилита symfony упрощает жизнь:

- создание проектов: symfony new ...
- запуск локального сервера: symfony serve
- проверки окружения и т.п.

Проверка:
symfony version

---

### База данных (по необходимости)

Если планируется работа с БД (Doctrine ORM и т.п.), нужна любая поддерживаемая СУБД:

- MySQL / MariaDB
- PostgreSQL
- SQLite (для локальной разработки часто достаточно)

Опционально: Redis / RabbitMQ и другие, если нужны кэш или очереди.

---

### Операционная система

Symfony работает на:

- macOS
- Linux
- Windows

Для этого репозитория можно явно указать:

> В примерах далее предполагается работа на macOS (но шаги легко адаптируются под Linux/Windows).

---

### Быстрая самопроверка окружения

После установки всего необходимого можно проверить окружение командой:

symfony check:requirements

Она покажет, всё ли ок для запуска Symfony-проекта и каких расширений/настроек не хватает.

## 5. Быстрый старт на macOS

В этом разделе — минимальный набор шагов, чтобы запустить первый проект на Symfony на macOS.

### 5.1. Установить Homebrew

Homebrew — это пакетный менеджер для macOS, через него будем ставить всё остальное.

Официальная команда установки (выполнить в терминале):

/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

Проверка, что всё ок:
brew --version

---

### 5.2. Установить PHP

Через Homebrew ставим актуальную версию PHP:

brew install php

Проверяем версию:
php -v

(Если нужно явно, например php@8.3:
brew install php@8.3)

---

### 5.3. Установить Composer

Composer — менеджер зависимостей для PHP, без него Symfony-проект не живёт.

Установка через Homebrew:
brew install composer

Проверка:
composer -V

---

### 5.4. Установить Symfony CLI

Symfony CLI упростит создание и запуск проектов.

Установка:
brew install symfony-cli/tap/symfony-cli

Проверка:
symfony version

---

### 5.5. Создать новый проект Symfony

Переходим в папку, где хочешь держать проект, и создаём новый:

symfony new my_project --webapp

Либо через Composer (альтернатива):
composer create-project symfony/website-skeleton my_project

После создания:
cd my_project

---

### 5.6. Запуск локального сервера

Проще всего запустить встроенный сервер Symfony:

symfony serve

По умолчанию проект будет доступен по адресу:
http://127.0.0.1:8000
или
http://localhost:8000

Открой этот адрес в браузере — увидишь стартовую страницу Symfony.

---

### 5.7. Быстрая проверка, что всё ок

Внутри проекта выполни:

symfony check:requirements

Если все требования выполнены — окружение готово, можно переходить к изучению структуры проекта и написанию кода.

## 6. Создание нового проекта Symfony

В этом разделе — как именно создать новый проект Symfony разными способами и что означают варианты установки.

### 6.1. Вариант через Symfony CLI (рекомендуется)

Если установлен Symfony CLI, самый простой способ:

symfony new my_project --webapp

Здесь:
- my_project — имя папки/проекта (можно поменять).
- --webapp — готовый “полный” скелет: контроллеры, Twig, Doctrine, безопасность и т.п.

После создания:
cd my_project

---

### 6.2. Вариант через Composer

Если по какой-то причине не хочешь использовать Symfony CLI, можно создать проект напрямую через Composer.

Классический “website skeleton” (почти то же, что --webapp):

composer create-project symfony/website-skeleton my_project

Более минималистичный старт (только базовый фреймворк):

composer create-project symfony/skeleton my_project

Этот вариант ставит минимальную конфигурацию, а всё остальное ты добавляешь сам через composer require.

---

### 6.3. Добавление типичных пакетов к skeleton

Если начал с минимального symfony/skeleton, полезные команды:

Добавить поддержку веб-приложения (Twig, WebProfiler и т.п.):
composer require webapp

Добавить Doctrine ORM:
composer require orm

Добавить Twig (если ещё нет):
composer require twig

Добавить поддержку формы и валидации:
composer require form validator

---

### 6.4. Инициализация Git-репозитория

Часто сразу после создания проекта имеет смысл инициализировать Git:

cd my_project
git init
git add .
git commit -m "Initial Symfony project"

Можно упомянуть это прямо в README как рекомендуемый шаг, чтобы пользователю было проще стартовать и версионировать код.

---

### 6.5. Запуск проекта после создания

После любых вариантов создания проекта, для запуска локального сервера:

symfony serve

или, если без Symfony CLI:
php -S 127.0.0.1:8000 -t public

После этого открывай в браузере:
http://127.0.0.1:8000
или
http://localhost:8000

---

### 6.6. Что дальше?

После успешного запуска базового проекта логично перейти к разделам:

- “Структура проекта” — чтобы понять, какие папки за что отвечают.
- “Основы разработки на Symfony” — первый маршрут, контроллер и шаблон.

## 7. Структура проекта Symfony

После создания проекта Symfony внутри папки ты увидишь типичную структуру директорий и файлов. Понимание того, “что где лежит”, сильно упрощает работу.

Ниже — обзор основных папок и их назначения.

---

### 7.1. /bin

Содержит исполняемые файлы, в первую очередь:

- /bin/console — главный CLI-инструмент проекта.
  Через него запускаются команды:
  - миграции
  - генерация кода
  - очистка кэша
  - запуск тестов и т.п.

Примеры:
php bin/console cache:clear
php bin/console debug:router

---

### 7.2. /config

Все конфигурационные файлы проекта:

- /config/packages/ — настройки отдельных бандлов и компонентов (doctrine.yaml, twig.yaml, security.yaml и т.д.).
- /config/routes.yaml — маршруты по умолчанию.
- /config/routes/ — дополнительные файлы маршрутов (если разбиваешь по модулям).
- /config/services.yaml — регистрация сервисов, настройка автоконфигурации/автовызова.

Именно здесь задаётся большая часть “поведения” приложения: какие сервисы включены, какие бандлы активны, как настроены компоненты.

---

### 7.3. /public

Это “публичная” директория — документ-рутовая папка веб-сервера.

- index.php — front controller, точка входа для всех HTTP-запросов.

Именно эту папку должен видеть nginx/Apache/докерный веб-контейнер. Всё, что доступно пользователю через браузер (CSS, JS, картинки), обычно попадает сюда:

- /public/build — скомпилированные ассеты (если используешь Webpack Encore/Vite).
- /public/assets — статические файлы.

---

### 7.4. /src

Основной исходный код приложения.

Обычно содержит:

- /src/Controller — контроллеры (классы, обрабатывающие HTTP-запросы).
- /src/Entity — сущности Doctrine (модели данных, связанные с таблицами БД).
- /src/Repository — классы-репозитории для работы с БД.
- /src/Security — классы, связанные с безопасностью (User, Voter и т.п.).
- /src/Service (или /src/Application, /src/Domain и т.п.) — твои собственные сервисы и бизнес-логика.

Идея: контроллеры “тонкие”, бизнес-логика и работа с доменом — в сервисах/модулях внутри src.

---

### 7.5. /templates

Шаблоны Twig для отображения HTML, email и т.п.

- /templates/base.html.twig — базовый шаблон (layout), от которого наследуются остальные.
- /templates/controller_name/ — папки по контроллерам/модулям.
- /templates/security/ и т.д. — шаблоны для конкретных частей приложения.

Контроллер обычно возвращает рендер шаблона:
например, render('home/index.html.twig', ...)

---

### 7.6. /migrations

Файлы миграций базы данных (если используешь Doctrine Migrations).

Каждый файл описывает изменения схемы БД:
создание таблиц, изменение колонок, добавление индексов и т.п.

Примеры команд:
php bin/console make:migration
php bin/console doctrine:migrations:migrate

---

### 7.7. /var

Временные и служебные файлы:

- /var/cache — кэш приложения (отдельно для окружений dev/prod/test).
- /var/log — логи приложения.
- /var/sessions — сессии (если конфигурация настроена на файловое хранение).

Эта папка не должна попадать в репозиторий (обычно добавлена в .gitignore).

---

### 7.8. /vendor

Все зависимости, установленные через Composer.

- Symfony Framework Bundle
- Doctrine
- Twig
- прочие библиотеки и компоненты

Эта папка не коммитится в Git (также в .gitignore), её можно восстановить командой:
composer install

---

### 7.9. Файлы верхнего уровня

В корне проекта обычно есть:

- composer.json — список зависимостей и конфигурация Composer.
- composer.lock — “зафиксированные” версии пакетов.
- symfony.lock — список пакетов и рецептов Symfony Flex.
- .env — базовые ENV-переменные (под dev-окружение).
- .gitignore — список файлов/папок, игнорируемых Git.
- README.md — описание проекта.

---

### 7.10. Что важно запомнить вначале

Минимальный набор для старта:

- Контроллеры — в src/Controller
- Шаблоны — в templates/
- Маршруты и конфигурация — в config/
- Статика и точка входа — в public/

Понимая эту структуру, дальше гораздо проще читать примеры и документацию Symfony.

